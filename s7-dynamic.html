<script type="text/javascript">
    RED.nodes.registerType('s7-dynamic', {
        category: 'Ebermor',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-microchip",
        label: function () {
            return this.name || "s7-dynamic";
        }
    });
</script>

<script type="text/x-red" data-template-name="s7-dynamic">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Node name">
    </div>
</script>

<script type="text/x-red" data-help-name="s7-dynamic">
    <p>This node enables dynamic communication with a Siemens S7 PLC.</p>

    <h3>Configuration:</h3>
    <p>The PLC parameters must be provided dynamically via <code>msg.payload</code> in the following format:</p>

    <pre>
    {
        "ip": "192.168.18.100",
        "rack": 0,
        "slot": 2,
        "type": "input",
        "addresses": ["I0", "I1", "I2"]
    }
    </pre>

    <h3>Parameters:</h3>
    <ul>
        <li><b>ip</b>: PLC's IP address.</li>
        <li><b>rack</b>: PLC rack number.</li>
        <li><b>slot</b>: PLC slot number.</li>
        <li><b>type</b>: Operation type: "input", "output", or "memory".</li>
        <li><b>addresses</b>: List of addresses to read from or write to.</li>
    </ul>

    <h3>Example for Reading Inputs</h3>
    <pre>
    {
        "ip": "192.168.18.100",
        "rack": 0,
        "slot": 2,
        "type": "input",
        "addresses": ["I0", "I1", "I2"]
    }
    </pre>

    <h3>Example for Writing Outputs</h3>
    <pre>
    {
        "ip": "192.168.18.100",
        "rack": 0,
        "slot": 2,
        "type": "output",
        "addresses": {
            "Q0": true,
            "Q1": false
        }
    }
    </pre>

    <h3>Output:</h3>
    <p>The node returns a <code>msg.payload</code> containing the read values or confirmation of the write operation.</p>
</script>
